{% extends "layout/base_dashboard.html" %}
{% load static %}

{% block title %}Dashboard del Regente{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'cuentas/css/regente_dashboard.css' %}">
{% endblock %}

{% block content %}
<div class="dashboard-header">
  <h2>Panel del Regente</h2>
  <p>Controla rÃ¡pidamente tus cursos, asistencia y citaciones agendadas.</p>
</div>

{# ===== RESUMEN RÃPIDO ===== #}
<div class="dashboard-cards">
  <div class="dashboard-card">
    <div class="icon">ğŸ“š</div>
    <h3>Cursos a tu cargo</h3>
    <p>
      <strong>{{ total_cursos|default:"0" }}</strong> curso(s) asignados.
    </p>
  </div>

  <div class="dashboard-card">
    <div class="icon">ğŸ‘¥</div>
    <h3>Estudiantes</h3>
    <p>
      <strong>{{ total_estudiantes|default:"0" }}</strong> estudiante(s) en tus cursos.
    </p>
  </div>

  <div class="dashboard-card">
    <div class="icon">âœ…</div>
    <h3>Asistencia de hoy</h3>
    {% if pct_presentes_hoy is not None %}
      <p><strong>{{ pct_presentes_hoy }}%</strong> de presencia<br>
      <small>en {{ total_marcas_hoy }} registros de hoy.</small></p>
    {% else %}
      <p>No se ha registrado asistencia hoy.</p>
    {% endif %}
  </div>

  <div class="dashboard-card">
    <div class="icon">ğŸ“‘</div>
    <h3>Citaciones prÃ³ximas</h3>
    <p>
      <strong>{{ citaciones_proximas|length }}</strong> citaciÃ³n(es) agendadas para tus cursos.
    </p>
  </div>
</div>

{# ===== DETALLE: CURSOS & CITACIONES ===== #}
<div class="dashboard-cards" style="margin-top:32px;">
  <div class="dashboard-card" style="text-align:left;">
    <div class="icon">ğŸ«</div>
    <h3>Mis cursos</h3>
    {% if cursos %}
      <ul style="list-style:none; padding:0; margin-top:8px;">
        {% for c in cursos %}
          <li style="padding:6px 0; border-bottom:1px solid #eee;">
            <strong>{{ c.nombre }}</strong> â€“ <small>{{ c.paralelo }}</small><br>
            <a href="{% url 'cursos:detalle_curso' c.id %}">Ir al curso â†’</a>
          </li>
        {% endfor %}
      </ul>
      <p style="margin-top:10px;">
        <a href="{% url 'cursos:mis_cursos_regente' %}">Ver todos mis cursos â†’</a>
      </p>
    {% else %}
      <p>No tienes cursos asignados actualmente.</p>
    {% endif %}
  </div>

  <div class="dashboard-card" style="text-align:left;">
    <div class="icon">ğŸ•’</div>
    <h3>Citaciones agendadas</h3>
    {% if citaciones_proximas %}
      <table style="width:100%; font-size:0.9rem;">
        <thead>
          <tr>
            <th style="text-align:left;">Fecha</th>
            <th style="text-align:left;">Hora</th>
            <th style="text-align:left;">Estudiante</th>
            <th style="text-align:left;">Curso</th>
          </tr>
        </thead>
        <tbody>
          {% for c in citaciones_proximas %}
          <tr>
            <td>{{ c.fecha_citacion|date:"d/m" }}</td>
            <td>{{ c.hora_citacion|time:"H:i" }}</td>
            <td>{{ c.estudiante }}</td>
            <td>{{ c.estudiante.curso }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p>No hay citaciones prÃ³ximas para tus cursos.</p>
    {% endif %}

    <p style="margin-top:10px;">
      <a href="{% url 'citaciones:agendadas_mis_cursos' %}">Ver agenda completa â†’</a>
    </p>
  </div>
</div>

{# ===== ACCESOS RÃPIDOS ===== #}
<div class="dashboard-cards" style="margin-top:32px;">
  <div class="dashboard-card">
    <div class="icon">ğŸ“‹</div>
    <h3>Tomar asistencia</h3>
    <p>Ve a <strong>Mis cursos</strong> y selecciona el curso para registrar la asistencia.</p>
    <p><a href="{% url 'cursos:mis_cursos_regente' %}">Ir a Mis cursos â†’</a></p>
  </div>
  <div class="dashboard-card">
    <div class="icon">ğŸ—“ï¸</div>
    <h3>Calendario de asistencia</h3>
    <p>Revisa el calendario general de dÃ­as hÃ¡biles y reportes mensuales.</p>
    <p><a href="{% url 'estudiantes:asistencia_calendario' %}">Ver calendario â†’</a></p>
  </div>
</div>
{% endblock %}
